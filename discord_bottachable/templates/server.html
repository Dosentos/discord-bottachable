{% extends "base.html" %} 
{% load staticfiles %} 

{% block navigation %}
<header>
	<a class="brand" href="/{{server_id}}">{{server_name}}</a>
	<form class="form-inline my-2 my-lg-0" method="POST">
		{% csrf_token %}
		<input 
			name="keywords" class="form-control mr-sm-2" 
			type="text" placeholder="Search" aria-label="Search" 
			value="{{current_keywords|addSpaces}}" 
		/>
		<button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
	</form>
	<div class="measurement-area">
	<nav id="navigation">
		<ul class="okaynav-main">
			{% for c in channels %}
				<li class="okaynav-link">
					<a href="/{{server_id}}/{{c.name}}">#{{c.name}}</a>
				</li>
			{% endfor %}
		</ul>
	</nav>
	</div>
</header>
{% endblock %}
{% block content %}
<div class="row">
	{% if links.count == 0 %}
		<h2>Looks like I haven't collected any links for this server.</h2>
		<p>You can start by using <pre>!link</pre> command.</p>
	{% else %}
		{% for l in links %}
		<div class="col-12 col-sm-6 col-md-4 col-lg-3 col-xl-3">
			<div class="card">
				<a href="{{l.source}}">
					{% if l.media_url|length > 0 %}
						<img style="height: 200px;" class="card-img-top" src="{{l.media_url}}" alt="Card image cap" title="{{l.source}}" />
					{% endif %}
				</a>
				<div class="card-body">
					<a href="{{l.source}}" title="{{l.source}}">
						<h4 class="card-title">{{l.title}}</h4>
					</a>
					<p class="card-text">{{l.description}}</p>
					{% for t in l.tags.all %}
						{% with link=tag_links|get_item:l.id %}
							<a href="/{{server_id}}/{{link|get_item:t.id}}">
								<span class="badge badge-pill badge-secondary">{{t.name}}</span>
							</a>
						{% endwith %}
					{% endfor %}
				</div>
			</div>
		</div>
		{% endfor %}

		<!-- PAGINATION EXAMPLE -->
		<div class="pagination">
			<div class="step-links">
				{% if links.has_previous %}
					<a href="?page={{ links.previous_page_number }}">Previous</a>
				{% endif %}

				<span class="current">
					Page {{ links.number }} of {{ links.paginator.num_pages }}.
				</span>

				{% if links.has_next %}
					<a href="?page={{ links.next_page_number }}">next</a>
				{% endif %}
			</div>
		</div>
	{% endif %}
</div>
{% endblock %}